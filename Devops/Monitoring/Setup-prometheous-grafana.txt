The easiest and most common way to install Prometheus and Grafana for monitoring a Kubernetes cluster is by using the kube-prometheus-stack Helm chart. This single chart bundles all the necessary components for a complete, end-to-end monitoring solution.

The Installation Process
The process is straightforward and can be completed with a few commands, assuming you have a Kubernetes cluster and Helm installed.

Step 1: Add the Helm Repository
First, you need to add the official Prometheus Community Helm chart repository. This makes the kube-prometheus-stack chart available for installation.

Bash

helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
helm repo update

Step 2: Install the Helm Chart
Next, use the helm install command to deploy the entire monitoring stack to your cluster. It's a best practice to install it in a dedicated namespace, such as monitoring.

helm install my-release prometheus-community/kube-prometheus-stack --namespace monitoring --create-namespace


This single command deploys several key components:

Prometheus Operator: Automates the management of Prometheus and Alertmanager instances.

Prometheus: The core monitoring system that scrapes metrics.

Alertmanager: Handles alerting and notifications.

Grafana: The visualization tool for creating dashboards.

Exporters: Including kube-state-metrics and node-exporter to collect metrics from Kubernetes objects and nodes.


Step 3: Access Prometheus and Grafana
By default, the services are exposed internally with ClusterIP, meaning they are not accessible from outside the cluster. To access the dashboards, you need to use kubectl port-forward.

Accessing Grafana:

Bash

kubectl port-forward svc/my-release-grafana 3000:80 --namespace monitoring

Getting the Grafana Admin Password:
The initial admin password is a randomly generated secret. You can retrieve it with the following command:

kubectl get secret --namespace monitoring my-release-grafana -o jsonpath="{.data.admin-password}" | base64 --decode ; echo

Note: the default username is admin.

